window.Trails=function(){function t(){window.onhashchange=function(t){return function(e){var r;try{return t._handle(e.newURL)}catch(n){return r=n,console.error(r.message)}}}(this),window.onload=function(t){return function(){var e;try{return t._handle(window.location)}catch(r){return e=r,console.error(e.message)}}}(this)}return t.prototype.routes=[],t.prototype.beforeAllHandlers=[],t.prototype.afterAllHandlers=[],t.prototype.route=function(t,e){var r,n,o,a;return o=t,r=Array.prototype.slice.call(arguments),t=r.shift(),a=t.match(/:([\w\d]+)/g)||[],a=a.map(function(t){return t.substring(1)}),t=new RegExp("^"+t.replace(/\./,"\\.").replace(/\*/g,"(.+)").replace(/:([\w\d]+)/g,"([^/?]+)")+"$"),n={path:t,originalPath:o,handler:e,paramNames:a},this.routes.push(n)},t.prototype.before=function(t){return this.beforeAllHandlers.push(t)},t.prototype.after=function(t){return this.afterAllHandlers.push(t)},t.prototype.beforeAll=function(){var t,e,r,n,o;for(n=this.beforeAllHandlers,o=[],e=0,r=n.length;r>e;e++)t=n[e],o.push(t());return o},t.prototype.afterAll=function(){var t,e,r,n,o;for(n=this.afterAllHandlers,o=[],e=0,r=n.length;r>e;e++)t=n[e],o.push(t());return o},t.prototype.allRoutes=function(){return this.routes},t.prototype._handle=function(t){var e,r,n,o,a,l;if(o=document.createElement("a"),o.href=t,n=o.hash.replace("#!",""),0===n.length)return!1;if(a=this._match(n),!a.handler)throw new Error("ONOEZ!  Could not find a matching route for "+n);return r={},l=a.path.exec(n),l&&(l.shift(),l.map(decodeURIComponent).forEach(function(t,e){return a.paramNames&&a.paramNames.length>e?r[a.paramNames[e]]=t:t?(r.splat=r.splat||[],r.splat.push(t)):void 0})),e={route:a.originalPath,computed:n,params:r},this.beforeAllHandlers.length>0&&this.beforeAll(e),a.handler(e),this.afterAllHandlers.length>0?this.afterAll(e):void 0},t.prototype._match=function(t){var e,r,n,o,a;for(r={},a=this.routes,n=0,o=a.length;o>n;n++)e=a[n],t.match(e.path||decodeURIComponent(t).match(e.path))&&(r=e);return r},t}();